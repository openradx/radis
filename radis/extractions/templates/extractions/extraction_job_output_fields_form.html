{% extends "extractions/extractions_layout.html" %}
{% load crispy from crispy_forms_tags %}
{% load bootstrap_icon from common_extras %}
{% block title %}
    New Extraction Job
{% endblock title %}
{% block heading %}
    <c-page-heading title="New Extraction Job - Define Fields (Step 1 of 3)">
    <c-slot name="left">
    <button type="button"
            class="btn btn-info"
            hx-get="{% url 'extraction_help' %}"
            hx-target="#htmx-dialog">
        Help
        {% bootstrap_icon "question-circle" %}
    </button>
    </c-slot>
    </c-page-heading>
{% endblock heading %}
{% block content %}
    <div class="row">
        <div class="col-8">
            <form action="" method="post" x-data="FormSet($el)">
                {% csrf_token %}
                {{ wizard.management_form }}
                <c-formset :formset="formset" add-form-label="Add Field" />
                <div class="d-flex justify-content-between">
                    <div class="d-flex gap-2">
                        <button type="submit"
                                name="wizard_goto_step"
                                value="{{ wizard.steps.prev }}"
                                class="btn btn-secondary"
                                disabled>Previous Step</button>
                        <button type="submit" class="btn btn-primary">Next Step (Search Query)</button>
                    </div>
                </div>
            </form>
        </div>
        <div class="col-4">
            <p>
                <strong>Step 1:</strong> Define the fields you want to extract from medical reports.
            </p>
            <p>
                Choose a short and concise name and more detailed description for each field.
                You can add up to 5 fields.
            </p>
            <p>
                In the next step, we will automatically generate a search query based on these fields,
                which you can then review and refine.
            </p>
            <p>
                Example for an output field:
                <br />
                <em>Name:</em> lung_nodule_size
                <br />
                <em>Description:</em> The size of the largest found lung nodule in millimeters.
            </p>
        </div>
    </div>
{% endblock content %}
