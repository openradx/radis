{% load bootstrap_icon from common_extras %}
{% if error %}
    <div class="alert alert-warning mb-4" role="alert">
        <h5 class="alert-heading">{% bootstrap_icon "exclamation-triangle" %} Query Generation Failed</h5>
        <p>{{ error }}</p>
        <p class="mb-0">
            <small>
                You can manually enter a search query below.
                The query will help find relevant medical reports for your extraction.
            </small>
        </p>
    </div>
{% elif generated_query %}
    <div class="alert alert-success mb-4" role="alert">
        <h5 class="alert-heading">{% bootstrap_icon "check-circle" %} Query Generated Successfully</h5>
        <p>
            Based on your {{ output_fields_count }} extraction field{{ output_fields_count|pluralize }},
            we generated the following search query:
        </p>
        <code class="d-block bg-light p-2 mb-2">{{ generated_query }}</code>
        <p class="mb-0">
            <small>
                You can edit this query below to refine your search.
                The query will help find relevant medical reports for your extraction.
            </small>
        </p>
    </div>
    {# Update the query input field using out-of-band swap #}
    <input type="text"
           name="1-query"
           value="{{ generated_query }}"
           hx-swap-oob="true"
           id="id_1-query"
           class="textinput textInput form-control"
           maxlength="500"
           placeholder="Auto-generated query (editable)" />
{% else %}
    <div class="alert alert-info mb-4" role="alert">
        <h5 class="alert-heading">{% bootstrap_icon "info-circle" %} No Query Generated</h5>
        <p class="mb-0">
            <small>Please manually enter a search query below.</small>
        </p>
    </div>
{% endif %}
